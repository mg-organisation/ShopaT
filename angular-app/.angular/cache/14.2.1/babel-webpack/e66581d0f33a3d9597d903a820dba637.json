{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Dell/shopathome/shopathome/angular-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./product.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../shared/list-header.component\";\nimport * as i4 from \"../shared/modal.component\";\nimport * as i5 from \"./product-list.component\";\nimport * as i6 from \"./product-detail.component\";\n\nfunction ProductsComponent_div_3_app_product_list_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-product-list\", 8);\n    i0.ɵɵlistener(\"selected\", function ProductsComponent_div_3_app_product_list_1_Template_app_product_list_selected_0_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r4.select($event));\n    })(\"deleted\", function ProductsComponent_div_3_app_product_list_1_Template_app_product_list_deleted_0_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r6.askToDelete($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const products_r1 = i0.ɵɵnextContext().ngIf;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"products\", products_r1)(\"errorMessage\", ctx_r2.errorMessage);\n  }\n}\n\nfunction ProductsComponent_div_3_app_product_detail_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-product-detail\", 9);\n    i0.ɵɵlistener(\"unselect\", function ProductsComponent_div_3_app_product_detail_2_Template_app_product_detail_unselect_0_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r8.clear());\n    })(\"save\", function ProductsComponent_div_3_app_product_detail_2_Template_app_product_detail_save_0_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r10.save($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"product\", ctx_r3.selected);\n  }\n}\n\nfunction ProductsComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵtemplate(1, ProductsComponent_div_3_app_product_list_1_Template, 1, 2, \"app-product-list\", 6);\n    i0.ɵɵtemplate(2, ProductsComponent_div_3_app_product_detail_2_Template, 1, 1, \"app-product-detail\", 7);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.selected);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.selected);\n  }\n}\n\nexport let ProductsComponent = /*#__PURE__*/(() => {\n  class ProductsComponent {\n    constructor(productService) {\n      this.productService = productService;\n      this.message = '?';\n      this.showModal = false;\n      this.products$ = productService.entities$;\n    }\n\n    ngOnInit() {\n      this.getProducts();\n    }\n\n    add(product) {\n      this.productService.add(product);\n    }\n\n    askToDelete(product) {\n      this.productToDelete = product;\n      this.showModal = true;\n\n      if (this.productToDelete.name) {\n        this.message = `Would you like to delete ${this.productToDelete.name}?`;\n      }\n    }\n\n    clear() {\n      this.selected = null;\n    }\n\n    closeModal() {\n      this.showModal = false;\n    }\n\n    deleteProduct() {\n      this.closeModal();\n\n      if (this.productToDelete) {\n        this.productService.delete(this.productToDelete.id).subscribe(() => this.productToDelete = null);\n      }\n\n      this.clear();\n    }\n\n    enableAddMode() {\n      this.selected = {};\n    }\n\n    getProducts() {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        _this.errorMessage = undefined;\n\n        _this.productService.getAll().subscribe(_ => {\n          /*.. do nothing for success.. */\n        }, // (error: any) => (this.errorMessage = error.error.message),\n        error => _this.errorMessage = 'Unauthorized');\n\n        _this.clear();\n      })();\n    }\n\n    save(product) {\n      if (this.selected && this.selected.name) {\n        this.update(product);\n      } else {\n        this.add(product);\n      }\n    }\n\n    select(product) {\n      this.selected = product;\n    }\n\n    update(product) {\n      this.productService.update(product);\n    }\n\n  }\n\n  ProductsComponent.ɵfac = function ProductsComponent_Factory(t) {\n    return new (t || ProductsComponent)(i0.ɵɵdirectiveInject(i1.ProductService));\n  };\n\n  ProductsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProductsComponent,\n    selectors: [[\"app-products\"]],\n    decls: 6,\n    vars: 5,\n    consts: [[1, \"content-container\"], [\"title\", \"My List\", 3, \"add\", \"refresh\"], [1, \"columns\", \"is-multiline\", \"is-variable\"], [\"class\", \"column is-8\", 4, \"ngIf\"], [1, \"modal-product\", 3, \"message\", \"isOpen\", \"handleNo\", \"handleYes\"], [1, \"column\", \"is-8\"], [3, \"products\", \"errorMessage\", \"selected\", \"deleted\", 4, \"ngIf\"], [3, \"product\", \"unselect\", \"save\", 4, \"ngIf\"], [3, \"products\", \"errorMessage\", \"selected\", \"deleted\"], [3, \"product\", \"unselect\", \"save\"]],\n    template: function ProductsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"app-list-header\", 1);\n        i0.ɵɵlistener(\"add\", function ProductsComponent_Template_app_list_header_add_1_listener() {\n          return ctx.enableAddMode();\n        })(\"refresh\", function ProductsComponent_Template_app_list_header_refresh_1_listener() {\n          return ctx.getProducts();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵtemplate(3, ProductsComponent_div_3_Template, 3, 2, \"div\", 3);\n        i0.ɵɵpipe(4, \"async\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"app-modal\", 4);\n        i0.ɵɵlistener(\"handleNo\", function ProductsComponent_Template_app_modal_handleNo_5_listener() {\n          return ctx.closeModal();\n        })(\"handleYes\", function ProductsComponent_Template_app_modal_handleYes_5_listener() {\n          return ctx.deleteProduct();\n        });\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(4, 3, ctx.products$));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"message\", ctx.message)(\"isOpen\", ctx.showModal);\n      }\n    },\n    dependencies: [i2.NgIf, i3.ListHeaderComponent, i4.ModalComponent, i5.ProductListComponent, i6.ProductDetailComponent, i2.AsyncPipe],\n    encapsulation: 2\n  });\n  return ProductsComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}